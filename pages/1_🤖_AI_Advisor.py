import streamlit as st
import pandas as pd
import numpy as np
from data.fetcher import get_etf_options

st.set_page_config(
    page_title="AI 投資顧問",
    page_icon="🤖",
    layout="wide"
)

st.title("🤖 AI 智能投資顧問")
st.caption("回答幾個問題，讓 AI 為您打造專屬投資組合")

# ============================================================================
# Coming Soon Message
# ============================================================================
st.info("🚧 **功能開發中** | 此頁面即將推出，敬請期待！")

st.markdown("---")

# ============================================================================
# Preview: What This Page Will Do
# ============================================================================
st.markdown("## 📋 功能預覽")

col1, col2 = st.columns(2)

with col1:
    st.markdown("### 📝 智能問卷")
    st.write("""
    系統將詢問您以下問題：
    - 年齡與投資經驗
    - 風險承受能力
    - 投資目標（退休、購屋、子女教育）
    - 投資期限
    - 月投入金額
    """)
    
    st.markdown("### 🎯 AI 分析")
    st.write("""
    基於您的回答，AI 將：
    - 評估風險偏好等級
    - 計算建議資產配置
    - 推薦適合的 ETF 組合
    - 預估達成目標機率
    """)

with col2:
    st.markdown("### 💼 推薦組合範例")
    
    sample_portfolios = {
        "保守型": {"0050": 70, "0056": 30},
        "穩健型": {"0050": 50, "0056": 30, "00878": 20},
        "積極型": {"0050": 40, "0056": 20, "00878": 20, "00919": 20},
    }
    
    risk_profile = st.selectbox(
        "選擇風險偏好（示範）",
        options=list(sample_portfolios.keys())
    )
    
    portfolio = sample_portfolios[risk_profile]
    
    st.write("**建議配置**：")
    for etf, weight in portfolio.items():
        st.progress(weight / 100, text=f"{etf}: {weight}%")

# ============================================================================
# Temporary: Manual Portfolio Builder
# ============================================================================
st.markdown("---")
st.markdown("## 🛠️ 臨時功能：手動建立組合")
st.write("在 AI 功能完成前，您可以先到「策略實驗室」手動配置投資組合。")

if st.button("前往策略實驗室 →", type="primary"):
    st.switch_page("pages/2_🧪_Backtest_Lab.py")

# ============================================================================
# Educational Content
# ============================================================================
st.markdown("---")
st.markdown("## 📚 投資知識小學堂")

with st.expander("🎓 什麼是資產配置？"):
    st.write("""
    資產配置是指將投資金額分散到不同的資產類別，以降低風險並優化報酬。
    
    **常見配置策略**：
    - **保守型**：70% 市值型 + 30% 高股息
    - **穩健型**：50% 市值型 + 50% 高股息
    - **積極型**：60% 市值型 + 40% 高股息或主題型
    
    **重要原則**：
    - 不要把所有雞蛋放在同一個籃子裡
    - 定期檢視並再平衡
    - 長期持有，避免頻繁交易
    """)

with st.expander("💡 如何選擇適合自己的 ETF？"):
    st.write("""
    選擇 ETF 時，考慮以下因素：
    
    1. **投資目標**：
       - 追求成長 → 市值型 ETF（如 0050）
       - 追求現金流 → 高股息 ETF（如 0056、00878）
    
    2. **風險承受度**：
       - 保守 → 低波動、高股息
       - 積極 → 高成長、可接受波動
    
    3. **投資期限**：
       - 長期（10年+）→ 市值型為主
       - 中短期（3-5年）→ 平衡配置
    
    4. **費用**：
       - 查看管理費率（越低越好）
       - 注意交易手續費
    """)

with st.expander("⚠️ 投資風險提示"):
    st.write("""
    投資必定伴隨風險，請務必了解：
    
    - **市場風險**：股市波動可能導致虧損
    - **匯率風險**：若持有海外 ETF
    - **流動性風險**：某些 ETF 交易量較小
    - **槓桿風險**：使用融資可能放大損失
    
    **建議**：
    - 只投資您了解的產品
    - 不要使用借來的錢投資
    - 保留 6 個月的緊急備用金
    - 分散投資，避免過度集中
    """)

st.markdown("---")
st.info("💡 **提示**：AI 顧問功能預計在下一個版本推出，將提供更智能的投資建議！")
